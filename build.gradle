buildscript {
    ext.spek_version = "1.1.5"
    ext.kotlintest_version = "2.0.7"
    ext.spring_autoconfigure_version = "2.0.0.RELEASE"
    ext.spring_data_version = "2.0.5.RELEASE"
    ext.hibernate_version = "5.2.12.Final"
    ext.jackson_version = "2.9.2"
    ext.h2_version = "1.4.196"
    ext.kohsuke_github_version = "1.90"
    ext.arrow_version = "0.7.3"
}

plugins {
    id "org.jetbrains.kotlin.plugin.spring" version "1.2.60" apply false
    id "org.jetbrains.kotlin.jvm" version "1.2.60" apply false
    id "org.junit.platform.gradle.plugin" version "1.0.3" apply false
    id "org.springframework.boot" version "2.0.0.RELEASE" apply false
}

configure(subprojects.findAll { it.name != 'frontend' }) {
    apply plugin: 'kotlin'

    repositories {
        mavenCentral()
        jcenter()
        maven { url "http://dl.bintray.com/jetbrains/spek" }
    }

    dependencies {
        // Kotlin
        compile "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
        compile "org.jetbrains.kotlin:kotlin-reflect"

        // Arrow
        compile "io.arrow-kt:arrow-core:$arrow_version"

        // Test
        testImplementation 'org.amshove.kluent:kluent:1.38'
        testCompile "org.jetbrains.kotlin:kotlin-test"

        testCompile "org.jetbrains.spek:spek-api:$spek_version"
        testCompile "org.jetbrains.spek:spek-data-driven-extension:$spek_version"
        testCompile "org.jetbrains.spek:spek-subject-extension:$spek_version"
        testRuntime "org.jetbrains.spek:spek-junit-platform-engine:$spek_version"

        // Mock
        testCompile "com.nhaarman:mockito-kotlin:1.5.0"

        // Json
        compile 'com.fasterxml.jackson.module:jackson-module-kotlin:2.9.4.1'
        compile 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.9.4'
    }

    compileKotlin { kotlinOptions.jvmTarget = "1.8" }
    compileTestKotlin { kotlinOptions.jvmTarget = "1.8" }
}

task wrapper(type: Wrapper) {
    gradleVersion = '4.9'
}